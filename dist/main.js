/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var st=Object.create;var U=Object.defineProperty;var it=Object.getOwnPropertyDescriptor;var rt=Object.getOwnPropertyNames;var at=Object.getPrototypeOf,ot=Object.prototype.hasOwnProperty;var ut=(p,$)=>()=>($||p(($={exports:{}}).exports,$),$.exports),ct=(p,$)=>{for(var n in $)U(p,n,{get:$[n],enumerable:!0})},K=(p,$,n,r)=>{if($&&typeof $=="object"||typeof $=="function")for(let o of rt($))!ot.call(p,o)&&o!==n&&U(p,o,{get:()=>$[o],enumerable:!(r=it($,o))||r.enumerable});return p};var dt=(p,$,n)=>(n=p!=null?st(at(p)):{},K($||!p||!p.__esModule?U(n,"default",{value:p,enumerable:!0}):n,p)),lt=p=>K(U({},"__esModule",{value:!0}),p);var Q=ut((F,J)=>{(function(p,$){typeof F=="object"&&typeof J!="undefined"?J.exports=$():typeof define=="function"&&define.amd?define($):(p=typeof globalThis!="undefined"?globalThis:p||self).dayjs=$()})(F,function(){"use strict";var p=1e3,$=6e4,n=36e5,r="millisecond",o="second",u="minute",l="hour",g="day",h="week",m="month",S="quarter",b="year",C="date",z="Invalid Date",X=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,tt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,et={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(a){var s=["th","st","nd","rd"],t=a%100;return"["+a+(s[(t-20)%10]||s[t]||s[0])+"]"}},P=function(a,s,t){var i=String(a);return!i||i.length>=s?a:""+Array(s+1-i.length).join(t)+a},nt={s:P,z:function(a){var s=-a.utcOffset(),t=Math.abs(s),i=Math.floor(t/60),e=t%60;return(s<=0?"+":"-")+P(i,2,"0")+":"+P(e,2,"0")},m:function a(s,t){if(s.date()<t.date())return-a(t,s);var i=12*(t.year()-s.year())+(t.month()-s.month()),e=s.clone().add(i,m),c=t-e<0,d=s.clone().add(i+(c?-1:1),m);return+(-(i+(t-e)/(c?e-d:d-e))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:m,y:b,w:h,d:g,D:C,h:l,m:u,s:o,ms:r,Q:S}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},x="en",A={};A[x]=et;var G="$isDayjsObject",V=function(a){return a instanceof W||!(!a||!a[G])},B=function a(s,t,i){var e;if(!s)return x;if(typeof s=="string"){var c=s.toLowerCase();A[c]&&(e=c),t&&(A[c]=t,e=c);var d=s.split("-");if(!e&&d.length>1)return a(d[0])}else{var v=s.name;A[v]=s,e=v}return!i&&e&&(x=e),e||!i&&x},y=function(a,s){if(V(a))return a.clone();var t=typeof s=="object"?s:{};return t.date=a,t.args=arguments,new W(t)},f=nt;f.l=B,f.i=V,f.w=function(a,s){return y(a,{locale:s.$L,utc:s.$u,x:s.$x,$offset:s.$offset})};var W=function(){function a(t){this.$L=B(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[G]=!0}var s=a.prototype;return s.parse=function(t){this.$d=function(i){var e=i.date,c=i.utc;if(e===null)return new Date(NaN);if(f.u(e))return new Date;if(e instanceof Date)return new Date(e);if(typeof e=="string"&&!/Z$/i.test(e)){var d=e.match(X);if(d){var v=d[2]-1||0,k=(d[7]||"0").substring(0,3);return c?new Date(Date.UTC(d[1],v,d[3]||1,d[4]||0,d[5]||0,d[6]||0,k)):new Date(d[1],v,d[3]||1,d[4]||0,d[5]||0,d[6]||0,k)}}return new Date(e)}(t),this.init()},s.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},s.$utils=function(){return f},s.isValid=function(){return this.$d.toString()!==z},s.isSame=function(t,i){var e=y(t);return this.startOf(i)<=e&&e<=this.endOf(i)},s.isAfter=function(t,i){return y(t)<this.startOf(i)},s.isBefore=function(t,i){return this.endOf(i)<y(t)},s.$g=function(t,i,e){return f.u(t)?this[i]:this.set(e,t)},s.unix=function(){return Math.floor(this.valueOf()/1e3)},s.valueOf=function(){return this.$d.getTime()},s.startOf=function(t,i){var e=this,c=!!f.u(i)||i,d=f.p(t),v=function(_,D){var O=f.w(e.$u?Date.UTC(e.$y,D,_):new Date(e.$y,D,_),e);return c?O:O.endOf(g)},k=function(_,D){return f.w(e.toDate()[_].apply(e.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(D)),e)},M=this.$W,w=this.$M,T=this.$D,E="set"+(this.$u?"UTC":"");switch(d){case b:return c?v(1,0):v(31,11);case m:return c?v(1,w):v(0,w+1);case h:var N=this.$locale().weekStart||0,I=(M<N?M+7:M)-N;return v(c?T-I:T+(6-I),w);case g:case C:return k(E+"Hours",0);case l:return k(E+"Minutes",1);case u:return k(E+"Seconds",2);case o:return k(E+"Milliseconds",3);default:return this.clone()}},s.endOf=function(t){return this.startOf(t,!1)},s.$set=function(t,i){var e,c=f.p(t),d="set"+(this.$u?"UTC":""),v=(e={},e[g]=d+"Date",e[C]=d+"Date",e[m]=d+"Month",e[b]=d+"FullYear",e[l]=d+"Hours",e[u]=d+"Minutes",e[o]=d+"Seconds",e[r]=d+"Milliseconds",e)[c],k=c===g?this.$D+(i-this.$W):i;if(c===m||c===b){var M=this.clone().set(C,1);M.$d[v](k),M.init(),this.$d=M.set(C,Math.min(this.$D,M.daysInMonth())).$d}else v&&this.$d[v](k);return this.init(),this},s.set=function(t,i){return this.clone().$set(t,i)},s.get=function(t){return this[f.p(t)]()},s.add=function(t,i){var e,c=this;t=Number(t);var d=f.p(i),v=function(w){var T=y(c);return f.w(T.date(T.date()+Math.round(w*t)),c)};if(d===m)return this.set(m,this.$M+t);if(d===b)return this.set(b,this.$y+t);if(d===g)return v(1);if(d===h)return v(7);var k=(e={},e[u]=$,e[l]=n,e[o]=p,e)[d]||1,M=this.$d.getTime()+t*k;return f.w(M,this)},s.subtract=function(t,i){return this.add(-1*t,i)},s.format=function(t){var i=this,e=this.$locale();if(!this.isValid())return e.invalidDate||z;var c=t||"YYYY-MM-DDTHH:mm:ssZ",d=f.z(this),v=this.$H,k=this.$m,M=this.$M,w=e.weekdays,T=e.months,E=e.meridiem,N=function(D,O,Y,H){return D&&(D[O]||D(i,c))||Y[O].slice(0,H)},I=function(D){return f.s(v%12||12,D,"0")},_=E||function(D,O,Y){var H=D<12?"AM":"PM";return Y?H.toLowerCase():H};return c.replace(tt,function(D,O){return O||function(Y){switch(Y){case"YY":return String(i.$y).slice(-2);case"YYYY":return f.s(i.$y,4,"0");case"M":return M+1;case"MM":return f.s(M+1,2,"0");case"MMM":return N(e.monthsShort,M,T,3);case"MMMM":return N(T,M);case"D":return i.$D;case"DD":return f.s(i.$D,2,"0");case"d":return String(i.$W);case"dd":return N(e.weekdaysMin,i.$W,w,2);case"ddd":return N(e.weekdaysShort,i.$W,w,3);case"dddd":return w[i.$W];case"H":return String(v);case"HH":return f.s(v,2,"0");case"h":return I(1);case"hh":return I(2);case"a":return _(v,k,!0);case"A":return _(v,k,!1);case"m":return String(k);case"mm":return f.s(k,2,"0");case"s":return String(i.$s);case"ss":return f.s(i.$s,2,"0");case"SSS":return f.s(i.$ms,3,"0");case"Z":return d}return null}(D)||d.replace(":","")})},s.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},s.diff=function(t,i,e){var c,d=this,v=f.p(i),k=y(t),M=(k.utcOffset()-this.utcOffset())*$,w=this-k,T=function(){return f.m(d,k)};switch(v){case b:c=T()/12;break;case m:c=T();break;case S:c=T()/3;break;case h:c=(w-M)/6048e5;break;case g:c=(w-M)/864e5;break;case l:c=w/n;break;case u:c=w/$;break;case o:c=w/p;break;default:c=w}return e?c:f.a(c)},s.daysInMonth=function(){return this.endOf(m).$D},s.$locale=function(){return A[this.$L]},s.locale=function(t,i){if(!t)return this.$L;var e=this.clone(),c=B(t,i,!0);return c&&(e.$L=c),e},s.clone=function(){return f.w(this.$d,this)},s.toDate=function(){return new Date(this.valueOf())},s.toJSON=function(){return this.isValid()?this.toISOString():null},s.toISOString=function(){return this.$d.toISOString()},s.toString=function(){return this.$d.toUTCString()},a}(),q=W.prototype;return y.prototype=q,[["$ms",r],["$s",o],["$m",u],["$H",l],["$W",g],["$M",m],["$y",b],["$D",C]].forEach(function(a){q[a[1]]=function(s){return this.$g(s,a[0],a[1])}}),y.extend=function(a,s){return a.$i||(a(s,W,y),a.$i=!0),y},y.locale=B,y.isDayjs=V,y.unix=function(a){return y(1e3*a)},y.en=A[x],y.Ls=A,y.p={},y})});var ft={};ct(ft,{default:()=>j});module.exports=lt(ft);var L=require("obsidian"),R=dt(Q()),ht={isNeedToAddCreatedAtDateOnToday:!0,isNeedToAddScheduledDateOnToday:!0},j=class extends L.Plugin{async onload(){await this.loadSettings(),this.addCommand({id:"tasks-enhancer-new-task",name:"New Task",editorCallback:n=>{let r=n.getCursor(),o=n.getLine(r.line),u=o.trim();if(u.startsWith("- [")&&!u.startsWith("- [ "))return;let l=o.match(/^(\s*)/),g=l?l[1]:"",h="";u.startsWith("- [")?h=g+u:h=g+"- [ ] "+u;let m=(0,R.default)().format("YYYY-MM-DD");this.settings.isNeedToAddCreatedAtDateOnToday&&!h.includes("\u2795")&&(h+=" \u2795 "+m),this.settings.isNeedToAddScheduledDateOnToday&&!h.includes("\u23F3")&&(h+=" \u23F3 "+m),n.setLine(r.line,h),this.adjustCursorPosition(n,h,"]",1)}}),this.addCommand({id:"tasks-enhancer-move-block-up",name:"Move block up",editorCallback:n=>{this.moveTaskBlock(n,"up")}}),this.addCommand({id:"tasks-enhancer-move-block-down",name:"Move block down",editorCallback:n=>{this.moveTaskBlock(n,"down")}}),this.addSettingTab(new Z(this.app,this)),this.registerDomEvent(document,"click",n=>{console.log("click",n)}),this.registerInterval(window.setInterval(()=>console.log("setInterval"),5*60*1e3))}onunload(){}async loadSettings(){this.settings=Object.assign({},ht,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}adjustCursorPosition(n,r,o,u){let l=n.getCursor(),g=r.indexOf(o);g!==-1?n.setCursor({line:l.line,ch:g+u+1}):console.log("Unable to set cursor position for line <"+r+"> after <"+o+">")}moveTaskBlock(n,r){let o=n.getCursor(),u=o.line,l=n.getLine(u);if(!l.trim().startsWith("- [")){console.log("Not a task, exiting");return}let g=this.getIndentLevel(l),h=this.findTaskBlock(n,u,g);if(!h){console.log("No task block found");return}if(r==="up"&&!this.canMoveUp(n,h.start)){console.log("Cannot move up - boundary reached");return}if(r==="down"&&!this.canMoveDown(n,h.end)){console.log("Cannot move down - boundary reached");return}let m;if(r==="up"?m=this.findTargetLineUp(n,u,g):m=this.findTargetLineDown(n,h.end,g),m===-1||m===h.start){console.log("Invalid target line, exiting");return}this.moveBlockSimple(n,h,m,r,o.ch)}canMoveUp(n,r){for(let o=r-1;o>=0;o--){let u=n.getLine(o);if(u.trim()!=="")return!!u.trim().startsWith("- [")}return!1}canMoveDown(n,r){let o=n.lineCount();for(let u=r+1;u<o;u++){let l=n.getLine(u);if(l.trim()!=="")return!!l.trim().startsWith("- [")}return!1}getIndentLevel(n){let r=n.match(/^(\s*)/);return r?r[1].length:0}findTaskBlock(n,r,o){let u=[],l=r,g=n.lineCount();for(u.push(n.getLine(r)),l=r+1;l<g;){let h=n.getLine(l);if(this.getIndentLevel(h)>o)u.push(h),l++;else break}return{start:r,end:r+u.length-1,lines:u}}findTargetLineUp(n,r,o){for(let u=r-1;u>=0;u--){let l=n.getLine(u);if(l.trim()==="")continue;let g=this.getIndentLevel(l);if(g===o)return u;if(g<o)return u+1}return 0}findTargetLineDown(n,r,o){let u=n.lineCount(),l=-1;for(let h=r+1;h<u;h++){let m=n.getLine(h);if(m.trim()==="")continue;if(this.getIndentLevel(m)<=o){l=h;break}}if(l===-1)return console.log("No next block found, returning end:",u),u;let g=this.findTaskBlock(n,l,o);return g?g.end+1:(console.log("Could not find next block details, returning start:",l),l)}moveBlockSimple(n,r,o,u,l){let h=n.getValue().split(`
`),m=[...h.slice(0,r.start),...h.slice(r.end+1)],S=o;o>r.end&&(S=o-(r.end-r.start+1));let b=[...m.slice(0,S),...r.lines,...m.slice(S)];n.setValue(b.join(`
`));let C=S;l>0?n.setCursor({line:C,ch:Math.min(l,n.getLine(C).length)}):n.setCursor({line:C,ch:0})}},Z=class extends L.PluginSettingTab{constructor(n,r){super(n,r);this.plugin=r}display(){let{containerEl:n}=this;n.empty(),new L.Setting(n).setName("Task creation").setHeading(),new L.Setting(n).setName("Need to add date of creation of task").setDesc("Add current date as date of creation while creating of task").addToggle(r=>r.setValue(this.plugin.settings.isNeedToAddCreatedAtDateOnToday).onChange(async o=>{this.plugin.settings.isNeedToAddCreatedAtDateOnToday=o,await this.plugin.saveSettings()})),new L.Setting(n).setName("Need to add date of scheduling to task").setDesc("Add current date as date of scheduling while creating of task").addToggle(r=>r.setValue(this.plugin.settings.isNeedToAddScheduledDateOnToday).onChange(async o=>{this.plugin.settings.isNeedToAddScheduledDateOnToday=o,await this.plugin.saveSettings()}))}};
